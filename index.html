<!DOCTYPE HTML>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Valentine's Day Card</title>

	<link href="style.css" rel="stylesheet" text="text/css">
	<link rel="icon" href="bg.jpg">
</head>
<body background="bg.jpg">
<h1>Valentine's Day Card</h1>

<div class="card" style="display: none;">
	<div class="card-half">
		<img class="center" id="memeImage"> 
	</div>
	<div class="card-half">
		<p class="to-from" id="toMsg" style="float: left"></p><br>
		<p id="msg" style="clear: both;"></p>
		<p class="to-from" id="fromMsg" style="float: right"></p>
	</div>
</div>

<div class="container">
	<input class="input" type="text" id="to" placeholder="To:">
	<input class="input" type="text" id="from" placeholder="From:">
	<input class="input" type="text" id="message" placeholder="Enter a message">
	<button class="btn" id="msg-btn" onclick="showMessage()">Display message</button>

</div>

<script>
var memeImg = document.getElementById("memeImage");

function showMessage() {
	var message = document.getElementById("message").value;
	document.getElementById("msg").innerHTML = message;
	var to = document.getElementById("to").value;
	document.getElementById("toMsg").innerHTML = "To: " + to;
	var from = document.getElementById("from").value;
	document.getElementById("fromMsg").innerHTML = "From: " + from;

	getMeme();

	document.getElementById("message").value = "";
	document.getElementById("to").value = "";
	document.getElementById("from").value = "";
	document.getElementsByClassName("card")[0].style.display = '';

}

//This makes enter work
document.getElementById("message")
    .addEventListener("keyup", function(event) {
    event.preventDefault();
    if (event.keyCode === 13) {			 //ascii for enter is 13
        document.getElementById("msg-btn").click();
    }
});

//
var HttpClient = function() {
    this.get = function(aUrl, aCallback) {
        var anHttpRequest = new XMLHttpRequest();
        anHttpRequest.onreadystatechange = function() { 
            if (anHttpRequest.readyState == 4 && anHttpRequest.status == 200)
                aCallback(anHttpRequest.responseText);
        }

        anHttpRequest.open( "GET", aUrl, true );            
        anHttpRequest.send( null );
    }
}

function getMeme(){
	var client = new HttpClient();

	client.get('https://api.imgflip.com/get_memes', function(response) {
	    // do something with the response
	    let obj = JSON.parse(response); //make the JSON string into a JavaScript object
	    let randomNum = Math.floor(Math.random() * 100); //random number between 0-100
	    let randomMeme = obj.data.memes[randomNum]; //get a random meme
	    // console.log(obj);
	    // console.log(randomNum);
	    // console.log(obj.data.memes[randomNum]);
	    memeImage.src = randomMeme.url;
	    memeImage.height = 250;
	    memeImage.width = 350;
	});
}

</script>
</body>
</html>